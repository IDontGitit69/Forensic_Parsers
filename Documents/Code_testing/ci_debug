# ============================================================================
# YARA Rule Validation Pipeline - DEBUG VERSION
# ============================================================================

variables:
  PYTHON_IMAGE: "python:3.9"
  NEW_RULES_DIR: "New_Rules"
  BASELINE_DIR: "Baseline_Rules"
  REJECTED_DIR: "Rejected_Rules"
  DATABASE_PATH: "database/yara_rules.db"
  REPORTS_DIR: "reports"
  TEMP_DIR: "temp"

stages:
  - test

# ============================================================================
# Workflow Rules - Run on everything
# ============================================================================
workflow:
  rules:
    - when: always

# ============================================================================
# DEBUG JOB
# ============================================================================
debug_check:
  stage: test
  image: $PYTHON_IMAGE
  tags:
    - yara-validation  # ‚Üê REPLACE WITH YOUR ACTUAL TAG
  script:
    - echo "============================================"
    - echo "üîç DEBUG: Pipeline is running!"
    - echo "============================================"
    - echo ""
    - echo "Current directory:"
    - pwd
    - echo ""
    - echo "============================================"
    - echo "üìÅ Directory listing (root):"
    - echo "============================================"
    - ls -la
    - echo ""
    - echo "============================================"
    - echo "üîç Looking for New_Rules directory:"
    - echo "============================================"
    - ls -la New_Rules/ || echo "‚ùå New_Rules directory not found!"
    - echo ""
    - echo "============================================"
    - echo "üîç Looking for all directories:"
    - echo "============================================"
    - find . -maxdepth 2 -type d
    - echo ""
    - echo "============================================"
    - echo "üìÑ Looking for YARA files:"
    - echo "============================================"
    - find . -type f \( -name "*.yar" -o -name "*.yara" -o -name "*.rule" \) || echo "‚ùå No YARA files found"
    - echo ""
    - echo "============================================"
    - echo "üìä Git status:"
    - echo "============================================"
    - git status
    - echo ""
    - echo "============================================"
    - echo "‚úÖ DEBUG JOB COMPLETED"
    - echo "============================================"
